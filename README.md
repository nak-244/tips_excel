
## 数式の全体像を確認
では始めに数式の全体像を確認しましょう。まず、下の表は前のページでも紹介したものです。
![1](https://user-images.githubusercontent.com/45871453/59075520-fcc62380-890b-11e9-89f2-d09b0553b01b.jpg)

この例では「部署名」が総務部のデータのみを抜き出しています。そしてこの中で、セルA１５に入れた数式は次の通りです。

### 【セルA15の数式】

```rb
{=IFERROR(INDEX($A$3:$G$8,MATCH(

LARGE(($F$3:$F$8="総務部")*1/ROW($A$3:$A$8),ROWS($A$15:$A15)),

1/ROW($A$3:$A$8),0),COLUMNS($A$14:A$14)),"")}
```

このように全部で８個、７種類の関数を使います。正直慣れるまでは大変ですが、使いこなせるようになると便利ですので、順番にやってみましょう。

なお、下のように「数式バー」と呼ばれる所へ手で入力していくと楽なので、その手順で説明します。

### ### IFERROR関数とINDEX関数の部分
では始めの「IFERROR」と「INDEX」の部分です。

手で**「＝IFERROR(INDEX( 」**と入力します。

そしてカッコの次に入力するのは**「タイトル行を除く元の表全ての範囲」**です。

![2](https://user-images.githubusercontent.com/45871453/59075708-1caa1700-890d-11e9-9fff-41bd3132825b.jpg)

ここでデータが入っている部分、つまり「Ａ３～Ｇ８」までを指定し、「,（コンマ）」を入れます。

【入力した数式】

    =IFERROR(INDEX($A$3:$G$8,

ちなみに「＄」マークは付けた状態にしてください。

### MATCH関数＋LARGE関数の部分
次は、下のように**「MATCH(LARGE((」**と入力します。
![3](https://user-images.githubusercontent.com/45871453/59075749-4a8f5b80-890d-11e9-9022-e0e89fc1ce46.jpg)

そして次に入力するのは、**「条件を指定したい１列の範囲とその条件」**です。

ここでは、「部署名」が入ったF列の３～８行目に対して「総務部のみ」という条件で抽出したいので「$F$3:$F$8=”総務部”」となります。
